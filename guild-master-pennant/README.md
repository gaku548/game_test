# Guild Master Pennant

**パワプロのペナントモードをファンタジーに再解釈した2Dシミュレーションゲーム**

冒険者パーティの育成・構築・ドラフト・スカウト・移籍などをギルドが行い、どれくらいダンジョンを踏破できるかで競う自律開発プロジェクト。


- ✅ インストール不要
- ✅ PC・スマホ対応
- ✅ プッシュするたびに自動更新
- ✅ テスト戦闘をすぐ体験

---

## 🎮 ゲーム概要

### コンセプト
- **冒険者育成**: 5つの職業（戦士、魔法使い、僧侶、盗賊、弓使い）から選択
- **戦術的戦闘**: ユニコーンオーバーロード風の条件分岐型自動戦闘
- **隊列システム**: 前列3人・後列1人の2×3フォーメーション
- **ダンジョン踏破**: 連続戦闘で階層を進み、到達階層数で成績を評価
- **ペナント要素**: ドラフト、スカウト、トレード（将来実装）

### コアシステム

**1. 冒険者システム**
- **能力値**: HP、攻撃、防御、魔力、速度
- **職業**:
  - 戦士（高HP/攻撃）
  - 魔法使い（魔力特化）
  - 僧侶（回復）
  - 盗賊（速度）
  - 弓使い（バランス）

**2. 戦闘システム**
- ユニコーンオーバーロード風の戦術自動戦闘
- ターン制・速度順行動
- 位置による被弾率・能力修正

**3. 戦術システム**
- 条件（HP < X%, 敵の種類、味方の状態）→ 行動（攻撃、防御、スキル、回復）
- 優先度による複数戦術管理
- 職業別デフォルト戦術

**4. 隊列システム（2×3の前後列）**
```
前列: [1] [2] [3]  ← 被弾率60%、攻撃力+10%
後列:     [4]      ← 被弾率10%、防御力+10%
```

**5. スキルシステム**
- パワプロ特能風の倍率設定
- 攻撃スキル（強撃、ファイア、必殺剣）
- 回復スキル（ヒール、全体回復）
- 補助スキル（攻撃強化、防御強化）
- パッシブスキル（会心の一撃、カウンター、根性）

**6. ダンジョン踏破**
- 階層ごとに敵が1.1倍強化
- 連続戦闘で到達階層数を競う
- 階層に応じた敵編成

**7. 装備システム** ⭐ NEW
- 武器・防具・アクセサリーの3スロット制
- レアリティシステム（コモン～レジェンダリー）
- 装備によるステータスボーナスと特殊効果

**8. 状態異常システム** ⭐ NEW
- デバフ：毒、火傷、麻痺、気絶、睡眠、盲目
- バフ：攻撃力上昇、防御力上昇、速度上昇、HP回復
- ターン経過による効果管理

**9. 高度な敵AIシステム** ⭐ NEW
- 5つの行動パターン（攻撃的、防御的、戦術的、補助型、狂戦士）
- 状況判断による動的な行動選択
- ターゲット優先度の計算

**10. コンボシステム** ⭐ NEW
- スキル連鎖によるダメージ倍率上昇
- プリセットコンボ（火炎連鎖、戦士ラッシュ、暗殺技など）
- カスタムコンボの作成可能

**11. 育成システム** ⭐ NEW
- 経験値とレベルアップシステム
- 職業別成長率による能力上昇
- レベルアップによるスキル習得
- 特訓によるステータス強化
---

## 📁 プロジェクト構造

```
guild-master-pennant/
├── game/
│   └── scripts/          # 生成されたGDScriptファイル
│       ├── Adventurer.gd
│       ├── JobClass.gd
│       ├── CombatManager.gd
│       ├── CombatAction.gd
│       ├── TacticsSystem.gd
│       ├── TacticsCondition.gd
│       ├── PartyManager.gd
│       ├── SkillSystem.gd
│       ├── Skill.gd
│       ├── DungeonManager.gd
│       ├── EnemyGenerator.gd
│       ├── Equipment.gd              ⭐ NEW
│       ├── EquipmentManager.gd       ⭐ NEW
│       ├── StatusEffect.gd           ⭐ NEW
│       ├── StatusEffectManager.gd    ⭐ NEW
│       ├── EnemyBehavior.gd          ⭐ IMPROVED
│       ├── ComboSystem.gd            ⭐ NEW
│       └── TrainingSystem.gd         ⭐ NEW
│
├── agents/               # マルチエージェントシステム
│   ├── base_agent.py
│   ├── adventurer_agent.py
│   ├── combat_agent.py
│   ├── tactics_agent.py
│   ├── party_agent.py
│   ├── skill_agent.py
│   ├── dungeon_agent.py
│   ├── equipment_agent.py            ⭐ NEW
│   └── status_effect_agent.py        ⭐ NEW
│
├── blackboard.py         # 共有情報ストア
├── orchestrator.py       # エージェント統括
├── simulation.py         # バランスシミュレーション
├── requirements.txt      # Python依存関係
└── README.md             # このファイル
```

---

## 🚀 使い方

### 💻 ブラウザ版（最も簡単！）

- インストール不要
- PC・スマートフォン対応
- プッシュするたびに自動更新

### 🎮 Godot版（ローカル実行）

1. [Godot Engine 4.2+](https://godotengine.org/download) をダウンロード
2. Godotを起動し、「インポート」をクリック
3. `guild-master-pennant/game/project.godot` を選択
4. F5キーでゲーム実行

詳しくは [`game/README_GODOT.md`](game/README_GODOT.md) を参照。


#### 3. バランスシミュレーション

```bash
python simulation.py
```

さまざまなパーティ構成で何階層まで到達できるかをシミュレートします。

---

## 📊 実装完了の判断基準

- [x] エージェント間でメッセージをやり取りしている
- [x] Blackboardで情報を共有している
- [x] エージェントが自律的に動いている（think()メソッド）
- [x] GDScriptファイルが実際に生成される（6システム）
- [x] バランスシミュレーションが実行される
- [x] 対話モードで操作できる

---

## 🎯 生成されるGDScriptファイル

### 1. 冒険者システム
- **Adventurer.gd** - 冒険者クラス（能力値、ステータス、位置修正）
- **JobClass.gd** - 職業定義（5職業と基礎能力値）

### 2. 戦闘システム
- **CombatManager.gd** - 戦闘管理（ターン制自動戦闘）
- **CombatAction.gd** - 戦闘アクション（行動実行、ダメージ計算）

### 3. 戦術システム
- **TacticsSystem.gd** - 戦術システム（条件分岐、優先度管理）
- **TacticsCondition.gd** - 戦術条件（HP、敵タイプなどの判定）

### 4. パーティ管理
- **PartyManager.gd** - パーティ管理（4人編成、前後列隊列）

### 5. スキルシステム
- **SkillSystem.gd** - スキルシステム（スキル実行、バフ管理）
- **Skill.gd** - スキルデータ定義（攻撃、回復、補助、パッシブ）

### 6. ダンジョン踏破
- **DungeonManager.gd** - ダンジョン管理（階層管理、連続戦闘）
- **EnemyGenerator.gd** - 敵生成（階層に応じた敵の生成と強化）

---

## 🔧 開発の流れ

### マルチエージェントによる自律開発

1. **Orchestrator** がすべてのエージェントを起動
2. 各エージェントが自律的に `think()` を実行
3. エージェントが **Blackboard** に情報を書き込み
4. 他のエージェントが Blackboard から情報を読み取り
5. エージェント間で **メッセージ** をやり取り
6. 各エージェントが担当する **GDScript** を生成
7. **設計決定** を記録し、タスクステータスを更新
8. すべてのシステムが完成

### Blackboardの役割

- エージェント間メッセージング
- システム状態の共有
- 生成されたコードの保存
- 設計決定の記録
- タスク管理

---

## 🧪 バランステスト

`simulation.py` では以下のパーティ構成がテストされます：

1. **戦士×3 + 僧侶** - 耐久重視
2. **戦士 + 魔法使い + 僧侶 + 弓使い** - バランス型
3. **戦士 + 盗賊 + 僧侶 + 魔法使い** - 速度重視
4. **盗賊×3 + 僧侶** - 超速攻
5. **弓使い×3 + 僧侶** - 後列火力

結果はランキング形式で表示されます。

---

## 🎨 再帰的改良の成果

このプロジェクトは**再帰的改良**により、基本システムから段階的に機能を拡張しました：

### フェーズ1: 基本システムの実装
- ✅ マルチエージェントシステムの構築
- ✅ 6つの基本システム（冒険者、戦闘、戦術、パーティ、スキル、ダンジョン）
- ✅ 11個のGDScriptファイルの自動生成

### フェーズ2: 拡張システムの追加
- ✅ **装備システム** - レアリティと特殊効果を持つアイテム
- ✅ **状態異常システム** - バフ/デバフの完全な実装
- ✅ **敵AIの高度化** - 5つの行動パターンと戦術的判断
- ✅ **コンボシステム** - スキル連鎖による戦略性向上
- ✅ **育成システム** - レベルアップとスキル習得

### 技術的成果
- 📝 合計**18個のGDScriptファイル**を生成
- 🤖 **8つの自律エージェント**が協調動作
- 🔧 完全に動作するマルチエージェント開発システム
- 📊 バランスシミュレーションによる検証

---

## 🌟 将来の実装予定

- **ドラフト会議** - 新人冒険者の獲得
- **スカウトシステム** - 有望な冒険者を発掘
- **FA・トレード** - 冒険者の移籍
- **AIギルド** - 他のギルドとの競争
- **リーグ戦** - ペナントモード本格実装
- **実際のゲーム化** - Godotでプレイ可能なゲームとして完成

---

## 📝 技術スタック

- **言語**: Python 3.8+ (マルチエージェントシステム), GDScript (Godot Engine 4.x)
- **ゲームエンジン**: Godot Engine 4.x (予定)
- **アーキテクチャ**: マルチエージェントシステム、Blackboard パターン
- **依存関係**: Python標準ライブラリのみ（外部ライブラリ不要）

---

## 🤝 コントリビューション

このプロジェクトは自律的なマルチエージェントシステムによって開発されていますが、
人間の開発者からのフィードバックや改善提案も歓迎します。
---

## 🙏 謝辞

- **パワプロ** - ペナントモードのインスピレーション
- **ユニコーンオーバーロード** - 戦術システムのインスピレーション
- **Godot Engine** - ゲームエンジン

---
